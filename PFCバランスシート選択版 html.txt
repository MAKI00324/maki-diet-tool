<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ›´å¹´æœŸä¸–ä»£å‘ã‘ãƒ€ã‚¤ã‚¨ãƒƒãƒˆè¨ˆç®—ãƒ„ãƒ¼ãƒ«</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 10px;
            background: linear-gradient(135deg, #a8e6cf 0%, #7fcdcd 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            max-width: 700px;
            margin: 0 auto;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin: 0 0 30px 0;
            font-size: 22px;
        }
        
        .step {
            background: #f0f8f0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #8BC34A;
        }
        
        .step-title {
            background: #8BC34A;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 15px;
        }
        
        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        label {
            font-weight: bold;
            color: #333;
            font-size: 14px;
        }
        
        input, select {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #8BC34A;
        }
        
        .target-section {
            background: #fff;
            border: 2px solid #8BC34A;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .weight-loss-goal {
            background: #ff6b6b;
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin: 15px 0;
        }
        
        .pace-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }
        
        .pace-card {
            background: #8BC34A;
            color: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .pace-card.selected {
            border-color: #2E7D32;
            background: #4CAF50;
        }
        
        .pace-card:hover {
            background: #7CB342;
        }
        
        .pace-title {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .pace-detail {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .method-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        
        .method-card {
            background: #f5f5f5;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .method-card.selected {
            border-color: #8BC34A;
            background: #f0f8f0;
        }
        
        .method-card:hover {
            border-color: #8BC34A;
        }
        
        .safety-note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 10px;
            border-radius: 6px;
            font-size: 13px;
            margin: 10px 0;
        }
        
        .result-section {
            background: linear-gradient(135deg, #8BC34A 0%, #4CAF50 100%);
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .result-summary {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .summary-card {
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .summary-title {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        
        .summary-value {
            font-size: 20px;
            font-weight: bold;
        }
        
        .pfc-section {
            margin-top: 15px;
        }
        
        .pfc-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .pfc-card {
            background: rgba(255,255,255,0.2);
            border-radius: 6px;
            padding: 12px;
            text-align: center;
        }
        
        .pfc-number {
            font-size: 18px;
            font-weight: bold;
        }
        
        .pfc-label {
            font-size: 12px;
            opacity: 0.9;
        }
        
        .next-button {
            background: #8BC34A;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: block;
            margin: 20px auto;
            transition: all 0.3s;
        }
        
        .next-button:hover {
            background: #7CB342;
            transform: translateY(-2px);
        }
        
        .warning, .success {
            border-radius: 6px;
            padding: 12px;
            margin: 15px 0;
            font-size: 14px;
        }
        
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }
        
        .success {
            background: #d1f2eb;
            border: 1px solid #7dcea0;
            color: #186a3b;
        }
        
        @media (max-width: 600px) {
            .input-row, .pace-options {
                grid-template-columns: 1fr;
            }
            
            .method-options {
                grid-template-columns: 1fr;
            }
            
            .result-summary {
                grid-template-columns: 1fr;
            }
            
            .pfc-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ¸ æ›´å¹´æœŸä¸–ä»£å‘ã‘ãƒ€ã‚¤ã‚¨ãƒƒãƒˆè¨ˆç®—ãƒ„ãƒ¼ãƒ«</h1>
        
        <!-- STEP1: åŸºæœ¬æƒ…å ± -->
        <div class="step">
            <div class="step-title">STEP1 åŸºæœ¬æƒ…å ±</div>
            
            <div class="input-row">
                <div class="input-group">
                    <label>å¹´é½¢</label>
                    <input type="number" id="age" value="50" min="40" max="70">
                </div>
                <div class="input-group">
                    <label>èº«é•·ï¼ˆcmï¼‰</label>
                    <input type="number" id="height" value="156" min="140" max="180" step="0.1">
                </div>
            </div>
            
            <div class="input-row">
                <div class="input-group">
                    <label>ç¾åœ¨ã®ä½“é‡ï¼ˆkgï¼‰</label>
                    <input type="number" id="current-weight" value="57" min="40" max="100" step="0.1">
                </div>
                <div class="input-group">
                    <label>æ´»å‹•ãƒ¬ãƒ™ãƒ«</label>
                    <select id="activity">
                        <option value="1.2">ã‚ã¾ã‚Šå‹•ã‹ãªã„</option>
                        <option value="1.375" selected>è»½ã„é‹å‹•</option>
                        <option value="1.55">ä¸­ç¨‹åº¦ã®é‹å‹•</option>
                        <option value="1.725">æ¿€ã—ã„é‹å‹•</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- STEP2: ç›®æ¨™è¨­å®š -->
        <div class="step">
            <div class="step-title">STEP2 ç›®æ¨™ä½“é‡ã‚’è¨­å®šã—ã¦ãã ã•ã„</div>
            
            <div class="target-section">
                <div class="input-group">
                    <label>ç›®æ¨™ä½“é‡ï¼ˆkgï¼‰</label>
                    <input type="number" id="target-weight" value="48" min="40" max="100" step="0.1">
                </div>
                
                <div class="weight-loss-goal" id="weight-loss-display">
                    æ¸›é‡ç›®æ¨™ -9.0kg
                </div>
                
                <div class="safety-note">
                    å¥åº·çš„ãªæ¸›é‡ãƒšãƒ¼ã‚¹ã¯ã€1ãƒ¶æœˆã«ç¾ä½“é‡ã®3ï½4%ä»¥å†…ã§ã™ã€‚ãã‚Œä»¥ä¸Šã¯å¥åº·ã‚’å®³ã™ã‚‹æã‚ŒãŒã‚ã‚‹ã®ã§ãŠã™ã™ã‚ã—ã¾ã›ã‚“ã€‚
                </div>
            </div>
        </div>
        
        <!-- STEP3: ãƒšãƒ¼ã‚¹é¸æŠ -->
        <div class="step">
            <div class="step-title">STEP3 ã©ã®ãã‚‰ã„ã®ãƒšãƒ¼ã‚¹ã§ãŒã‚“ã°ã‚Šã¾ã™ã‹ï¼Ÿ</div>
            
            <div class="pace-options">
                <div class="pace-card" data-pace="slow">
                    <div class="pace-title">ã‚†ã£ãã‚Š</div>
                    <div class="pace-detail">æœˆ<span id="slow-pace">1.1</span>kgï¼ˆå®‰å…¨ãƒšãƒ¼ã‚¹ï¼‰</div>
                </div>
                <div class="pace-card selected" data-pace="normal">
                    <div class="pace-title">ãŒã‚“ã°ã‚‹</div>
                    <div class="pace-detail">æœˆ<span id="normal-pace">1.7</span>kgï¼ˆæ¨å¥¨ä¸Šé™ï¼‰</div>
                </div>
            </div>
        </div>
        
        <!-- STEP4: PFCãƒãƒ©ãƒ³ã‚¹é¸æŠ -->
        <div class="step">
            <div class="step-title">STEP4 ã©ã®ã‚ˆã†ãªé£Ÿäº‹ãƒãƒ©ãƒ³ã‚¹ã«ã—ã¾ã™ã‹ï¼Ÿ</div>
            
            <div class="method-options">
                <div class="method-card" data-method="low-carb">
                    <div><strong>ç³–è³ªæ§ãˆã‚</strong></div>
                    <div style="font-size: 12px; margin-top: 5px;">P22% F35% C43%</div>
                </div>
                <div class="method-card selected" data-method="balance">
                    <div><strong>ãƒãƒ©ãƒ³ã‚¹é‡è¦–</strong></div>
                    <div style="font-size: 12px; margin-top: 5px;">P20% F30% C50%</div>
                </div>
                <div class="method-card" data-method="high-protein">
                    <div><strong>ç­‹ãƒˆãƒ¬å‘ã</strong></div>
                    <div style="font-size: 12px; margin-top: 5px;">P25% F30% C45%</div>
                </div>
            </div>
        </div>
        
        <button class="next-button" onclick="calculatePlan()">ç›®æ¨™è¨­å®šã‚’å®Œäº†ã™ã‚‹</button>
        
        <div id="warnings"></div>
        
        <!-- çµæœè¡¨ç¤º -->
        <div class="result-section" id="results" style="display: none;">
            <h3 style="margin: 0 0 15px 0; font-size: 18px;">ğŸ¯ ã‚ãªãŸã®å°‚ç”¨ãƒ—ãƒ©ãƒ³</h3>
            
            <div class="result-summary">
                <div class="summary-card">
                    <div class="summary-title">ç›®æ¨™é”æˆã¾ã§</div>
                    <div class="summary-value" id="duration">6ãƒ¶æœˆ</div>
                </div>
                <div class="summary-card">
                    <div class="summary-title">é”æˆäºˆå®šæ—¥</div>
                    <div class="summary-value" id="target-date">2026å¹´1æœˆ27æ—¥</div>
                </div>
                <div class="summary-card">
                    <div class="summary-title">æ‘‚å–ã‚«ãƒ­ãƒªãƒ¼</div>
                    <div class="summary-value" id="target-calories">1350kcal</div>
                </div>
                <div class="summary-card">
                    <div class="summary-title">æ¶ˆè²»ã‚«ãƒ­ãƒªãƒ¼</div>
                    <div class="summary-value" id="tdee">1650kcal</div>
                </div>
            </div>
            
            <div class="pfc-section">
                <h4 style="margin: 0 0 10px 0; font-size: 16px;">ğŸ½ï¸ PFCãƒãƒ©ãƒ³ã‚¹</h4>
                <div class="pfc-grid">
                    <div class="pfc-card">
                        <div class="pfc-number" id="protein-g">68</div>
                        <div class="pfc-label">ãŸã‚“ã±ãè³ªï¼ˆgï¼‰</div>
                    </div>
                    <div class="pfc-card">
                        <div class="pfc-number" id="fat-g">38</div>
                        <div class="pfc-label">è„‚è³ªï¼ˆgï¼‰</div>
                    </div>
                    <div class="pfc-card">
                        <div class="pfc-number" id="carb-g">186</div>
                        <div class="pfc-label">ç‚­æ°´åŒ–ç‰©ï¼ˆgï¼‰</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let selectedPace = 'normal';
        let selectedMethod = 'balance';
        
        // ãƒšãƒ¼ã‚¹é¸æŠ
        document.querySelectorAll('.pace-card').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('.pace-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                selectedPace = this.dataset.pace;
                updatePaceDisplay();
            });
        });
        
        // æ–¹æ³•é¸æŠ
        document.querySelectorAll('.method-card').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('.method-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                selectedMethod = this.dataset.method;
            });
        });
        
        function updateWeightLossDisplay() {
            const currentWeight = parseFloat(document.getElementById('current-weight').value);
            const targetWeight = parseFloat(document.getElementById('target-weight').value);
            const weightLoss = currentWeight - targetWeight;
            
            document.getElementById('weight-loss-display').textContent = 
                `æ¸›é‡ç›®æ¨™ ${weightLoss >= 0 ? '-' : '+'}${Math.abs(weightLoss).toFixed(1)}kg`;
            
            updatePaceDisplay();
        }
        
        function updatePaceDisplay() {
            const currentWeight = parseFloat(document.getElementById('current-weight').value);
            
            // å€‹åˆ¥ã«æœ€é©åŒ–ã•ã‚ŒãŸãƒšãƒ¼ã‚¹ï¼ˆä½“é‡ã®2%ã¨3%ï¼‰
            const slowPace = currentWeight * 0.02;  // ä½“é‡ã®2%ï¼ˆå®‰å…¨ãƒšãƒ¼ã‚¹ï¼‰
            const normalPace = currentWeight * 0.03; // ä½“é‡ã®3%ï¼ˆæ¨å¥¨ä¸Šé™ï¼‰
            
            document.getElementById('slow-pace').textContent = slowPace.toFixed(1);
            document.getElementById('normal-pace').textContent = normalPace.toFixed(1);
        }
        
        function calculateBMR(weight, height, age) {
            return Math.round(655 + (9.6 * weight) + (1.7 * height) - (4.7 * age));
        }
        
        function calculateTDEE(bmr, activity) {
            return Math.round(bmr * activity);
        }
        
        function getPFCRatios() {
            switch(selectedMethod) {
                case 'low-carb':
                    return {protein: 0.22, fat: 0.35, carb: 0.43};  // ç³–è³ªæ§ãˆã‚
                case 'balance':
                    return {protein: 0.20, fat: 0.30, carb: 0.50};  // ãƒãƒ©ãƒ³ã‚¹é‡è¦–ï¼ˆMakiã•ã‚“æ–¹å¼ï¼‰
                case 'high-protein':
                    return {protein: 0.25, fat: 0.30, carb: 0.45};  // ç­‹ãƒˆãƒ¬å‘ã
                default:
                    return {protein: 0.20, fat: 0.30, carb: 0.50};
            }
        }
        
        function calculatePlan() {
            const age = parseInt(document.getElementById('age').value);
            const height = parseFloat(document.getElementById('height').value);
            const currentWeight = parseFloat(document.getElementById('current-weight').value);
            const targetWeight = parseFloat(document.getElementById('target-weight').value);
            const activity = parseFloat(document.getElementById('activity').value);
            
            const weightLoss = Math.abs(currentWeight - targetWeight);
            const bmr = calculateBMR(currentWeight, height, age);
            const tdee = calculateTDEE(bmr, activity);
            
            // é¸æŠã•ã‚ŒãŸãƒšãƒ¼ã‚¹ã«åŸºã¥ãæœˆé–“æ¸›é‡é‡ï¼ˆå€‹åˆ¥è¨ˆç®—ï¼‰
            const monthlyLoss = selectedPace === 'slow' ? 
                currentWeight * 0.02 :  // ä½“é‡ã®2%
                currentWeight * 0.03;   // ä½“é‡ã®3%
            
            const duration = Math.ceil(weightLoss / monthlyLoss);
            const dailyDeficit = (monthlyLoss * 7200) / 30; // 1kg = 7200kcal
            let targetCalories = Math.round(tdee - dailyDeficit);
            
            const warningsDiv = document.getElementById('warnings');
            warningsDiv.innerHTML = '';
            
            // å®‰å…¨æ€§ãƒã‚§ãƒƒã‚¯
            if (targetCalories < bmr * 1.2) {
                const safeDuration = Math.ceil(weightLoss / (currentWeight * 0.02)); // 2%ãƒšãƒ¼ã‚¹ã§ã®æœŸé–“
                warningsDiv.innerHTML = `
                    <div class="warning">
                        ğŸ’¡ <strong>å®‰å…¨ã«ç›®æ¨™é”æˆã™ã‚‹ãŸã‚ã«</strong><br>
                        ${targetWeight}kgã¯ç´ æ™´ã‚‰ã—ã„ç›®æ¨™ã§ã™ï¼<br>
                        ã‚ˆã‚Šå¥åº·çš„ã«é”æˆã™ã‚‹ãŸã‚ã€æœŸé–“ã‚’${safeDuration}ãƒ¶æœˆã«èª¿æ•´ã—ã¾ã—ãŸã€‚<br>
                        <br>
                        <strong>æ¨å¥¨ãƒ—ãƒ©ãƒ³ï¼š</strong><br>
                        â€¢ æœŸé–“ï¼š${safeDuration}ãƒ¶æœˆï¼ˆæœˆ-${(weightLoss/safeDuration).toFixed(1)}kgï¼‰<br>
                        â€¢ ç„¡ç†ã®ãªã„ãƒšãƒ¼ã‚¹ã§ç¢ºå®Ÿã«é”æˆ<br>
                        â€¢ ãƒªãƒã‚¦ãƒ³ãƒ‰ã—ã«ãã„ä½“ä½œã‚Š<br>
                        <br>
                        <small>ã“ã®ãƒšãƒ¼ã‚¹ãªã‚‰ä½“ã«è² æ‹…ã‚’ã‹ã‘ãšã«ç†æƒ³ã®ä½“é‡ã‚’ç›®æŒ‡ã›ã¾ã™ï¼</small>
                    </div>
                `;
                targetCalories = Math.round(bmr * 1.2);
                // å®‰å…¨ãªæœŸé–“ã§å†è¨ˆç®—
                const safeDailyDeficit = (currentWeight * 0.02 * 7200) / 30;
                targetCalories = Math.round(tdee - safeDailyDeficit);
            } else {
                warningsDiv.innerHTML = `
                    <div class="success">
                        âœ… <strong>å®‰å…¨ãªè¨­å®šã§ã™ï¼</strong><br>
                        <small>ã“ã®è¨­å®šã§ç¶™ç¶šã™ã‚Œã°å¥åº·çš„ã«ç›®æ¨™é”æˆã§ãã¾ã™</small>
                    </div>
                `;
            }
            
            // ç›®æ¨™æ—¥è¨ˆç®—
            const targetDate = new Date();
            targetDate.setMonth(targetDate.getMonth() + duration);
            
            // PFCè¨ˆç®—
            const pfcRatios = getPFCRatios();
            const proteinG = Math.round(targetCalories * pfcRatios.protein / 4);
            const fatG = Math.round(targetCalories * pfcRatios.fat / 9);
            const carbG = Math.round(targetCalories * pfcRatios.carb / 4);
            
            // çµæœè¡¨ç¤º
            document.getElementById('duration').textContent = `${duration}ãƒ¶æœˆ`;
            document.getElementById('target-date').textContent = 
                `${targetDate.getFullYear()}å¹´${targetDate.getMonth() + 1}æœˆ${targetDate.getDate()}æ—¥`;
            document.getElementById('target-calories').textContent = `${targetCalories}kcal`;
            document.getElementById('tdee').textContent = `${tdee}kcal`;
            document.getElementById('protein-g').textContent = proteinG;
            document.getElementById('fat-g').textContent = fatG;
            document.getElementById('carb-g').textContent = carbG;
            
            document.getElementById('results').style.display = 'block';
        }
        
        // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
        document.getElementById('current-weight').addEventListener('input', updateWeightLossDisplay);
        document.getElementById('target-weight').addEventListener('input', updateWeightLossDisplay);
        
        // åˆæœŸè¡¨ç¤º
        updateWeightLossDisplay();
    </script>
</body>
</html>